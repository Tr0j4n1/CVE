# CVE-2025-9637 - Quiz and Survey Master (QSM) <= 10.3.1 - Missing Authorization to Unpublished, Private And Password-Protected Quiz Information Disclosure And Image Response Uploads

## Summary

**CVE-2025-9637** is a **missing authorization** vulnerability in the **Quiz And Survey Master (QSM)** plugin for WordPress.
The plugin registers WordPress AJAX actions that are accessible to unauthenticated users (via `wp_ajax_nopriv_*`) without an appropriate permission check and/or nonce validation.

As a result, an unauthenticated attacker can:

1. **Disclose complete quiz data (including restricted quizzes)**
        - The unauthenticated AJAX action `qsm_get_quiz_to_reload` returns the output of the `[qsm quiz="<id>"]` shortcode for an attacker-controlled `quiz_id`.
        - Because there is no authorization gate in the handler, this can expose quiz content even when the quiz is **unpublished**, **private**, or **password-protected**, depending on how the shortcode renders and what data is embedded in the returned HTML/JS (e.g., `qmn_quiz_data` object and question lists).

2. **Upload files without authentication ("image response uploads")**
        - When the upload handler is present in the affected build, the unauthenticated AJAX action `qsm_upload_image_fd_question` accepts a multipart file upload tied to a `question_id`.
        - This results in an **unauthorized write** into `wp-content/uploads/` (WordPress media library), gated by the configured allowed file types for the target File Upload question.

> Disclaimer: For authorized security testing only. Do not use this against systems you don’t own or do not have explicit permission to test.

---

## Affected Software

- **Product:** Quiz And Survey Master (QSM) plugin for WordPress (`quiz-master-next`)
- **Versions affected:** All versions **≤ 10.3.1**

### Vulnerable Version (for testing)

Download the last known affected build:

https://downloads.wordpress.org/plugin/quiz-master-next.10.3.1.zip

> Install only in a controlled lab/container environment.

---

## Vulnerability Details

- **Type:** Missing Authorization (Improper Access Control)
- **Vector:** Unauthenticated `POST` requests to WordPress AJAX endpoint
- **Endpoint:** `/wp-admin/admin-ajax.php`

### Affected AJAX Actions

#### 1) Quiz data disclosure

- **Action:** `qsm_get_quiz_to_reload`
- **Root cause:** unauthenticated exposure (nopriv) + missing authorization check for the requested `quiz_id`
- **Impact:** attacker can retrieve quiz HTML/JS for arbitrary IDs, potentially disclosing restricted quiz content and embedded data.

#### 2) Unauthenticated upload (image response uploads)

- **Action:** `qsm_upload_image_fd_question`
- **Root cause:** unauthenticated exposure (nopriv) + missing authorization check for the requested `question_id`
- **Impact:** unauthorized file upload to WordPress uploads directory, gated by allowed MIME types configured for the File Upload question.

---

## Exploit & Reproduction

1. Install a clean WordPress instance (local Docker / VM).
2. Upload and activate **Quiz And Survey Master (QSM) 10.3.1** (linked above).
3. Create (or identify) a **File Upload** question in a quiz and note its `question_id`.
4. Run the PoC script `CVE-2025-9637.py` to demonstrate the unauthenticated upload primitive.

Example usage:

```bash
python3 CVE-2025-9637.py \
        --url http://localhost \
        --question-id 123 \
        --file ./benign.png
```

Optional: force MIME type (defaults to `image/png`):

```bash
python3 CVE-2025-9637.py \
        --url http://localhost \
        --question-id 123 \
        --file ./benign.png \
        --mime image/png
```

---

## Notes / Troubleshooting

- If the server responds with literal `0` (the script shows `raw: 0`), WordPress typically did **not** recognize the AJAX `action` (not registered / patched / different code path).
- The upload is usually **gated by question configuration**. The provided `question_id` must correspond to a file-upload question configured to allow your file type.

---

## References

- WordPress plugin page: https://wordpress.org/plugins/quiz-master-next/
- Vendor site: https://quizandsurveymaster.com/
