# CVE-2025-9318 - Quiz and Survey Master (QSM) <= 10.3.1 - Authenticated (Subscriber+) SQL Injection via `is_linking` Query Parameter

## Summary

**CVE-2025-9318** is an **authenticated SQL Injection** vulnerability in the **Quiz And Survey Master (QSM)** plugin for WordPress.
The issue is triggered through the QSM REST API questions endpoint by abusing the `is_linking` parameter, which is handled in a way that allows SQL fragments to be injected into a backend query.

This can lead to **time-based blind SQL injection** and **extraction of sensitive database information** (e.g., WordPress user credentials/hashes), even with a **low-privileged account** (such as `subscriber`).

> Disclaimer: For authorized security testing only. Do not use this against systems you don’t own or do not have explicit permission to test.

---

## Affected Software

- **Product:** Quiz And Survey Master (QSM) plugin for WordPress (`quiz-master-next`)
- **Versions affected:** All versions **≤ 10.3.1**

### Vulnerable Version (for testing)

Download the last known affected build:

https://downloads.wordpress.org/plugin/quiz-master-next.10.3.1.zip

> Install only in a controlled lab/container environment.

---

## Vulnerability Details

- **Type:** SQL Injection (Improper Neutralization of Special Elements used in an SQL Command)
- **Vector:** Authenticated HTTP request to QSM REST API endpoint with a crafted `is_linking` parameter
- **Endpoint:** `/wp-json/quiz-survey-master/v1/questions/<question_id>`
- **Parameter:** `is_linking`
- **Authentication:** Required (any logged-in user; tested with `subscriber`)
- **Impact:** Time-based SQL injection → database extraction (blind), depending on DB permissions and site configuration

### Root Cause (high level)

The `is_linking` request parameter is used to build a SQL `IN (...)` clause in a way that allows attacker-controlled input to reach the query without proper sanitization/parameterization.
A payload like:

`1) OR SLEEP(2)-- `

can break out of the `IN (...)` list and force a measurable delay, confirming injection.

---

## Exploit & Reproduction

1. Install a clean WordPress instance (local Docker / VM).
2. Upload and activate **Quiz And Survey Master (QSM) 10.3.1** (linked above).
3. Create a low-privileged WordPress user (e.g., `subscriber`) and ensure at least one QSM question exists.
4. Run the provided exploit script to check the vulnerability and optionally dump data.

### Check (time-based)

```bash
python3 CVE-2025-9318.py \
        -u http://localhost \
        -U subscriber \
        -P 'subscriber@123' \
        --check
```

### Dump users (blind extraction)

```bash
python3 CVE-2025-9318.py \
        -u http://localhost \
        -U subscriber \
        -P 'subscriber@123' \
        --dump
```

### Custom query

```bash
python3 CVE-2025-9318.py \
        -u http://localhost \
        -U subscriber \
        -P 'subscriber@123' \
        --query "SELECT user_login FROM wp_users WHERE ID=1"
```

---

## Notes / Troubleshooting

- The exploit requires a valid `question_id`. If not provided, the script attempts to find one by probing IDs `1..10`.
- This is **time-based blind** SQL injection; results depend on latency/jitter. If results are unstable, increase `--timeout` or repeat the check.
- WordPress table prefix may not be `wp_` on all targets. The provided dump logic assumes the default `wp_` prefix.

---

## References

- WordPress plugin page: https://wordpress.org/plugins/quiz-master-next/
- Vendor site: https://quizandsurveymaster.com/
